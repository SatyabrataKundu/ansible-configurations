  - name: Configure Disk Group Policy
    ucs_disk_group_policy:
      hostname: "{{ ucs_hostname }}"
      username: "{{ ucs_username }}"
      password: "{{ ucs_password }}"
      state: present
      name: "{{ item.name }}"
      description: "{{ item.description }}"
      raid_level: "{{ item.raid_level }}"
      configuration_mode: "{{ item.configuration_mode }}"
      num_drives: "{{ item.num_drives }}"
      drive_type: "{{ item.drive_type }}"
      org_dn: "{{ item.org_dn }}"
      virtual_drive:
        access_policy: "{{ item.access_policy }}"
    loop:
      - {
          name: 'ESX-HOST-2DSK-HD', description: 'ESX HOST 2 HDD RAID 1', raid_level: 'mirror', configuration_mode: 'automatic',
          num_drives: '2', drive_type: 'HDD', org_dn: 'org-root/org-PROD/org-VMW', access_policy: 'platform-default'
        }
      - { 
          name: 'ESX-MGMT-D01-R1', description: 'ESX HOST 2 HDD RAID 1', raid_level: 'mirror', configuration_mode: 'automatic',
          num_drives: '2', drive_type: 'HDD', org_dn: 'org-root/org-PROD/org-VMW', access_policy: 'platform-default'
        }
      - {
          name: 'ESX-MGMT-D01-R2', description: 'ESX HOST 2 HDD RAID 1', raid_level: 'mirror', configuration_mode: 'automatic',
          num_drives: '2', drive_type: 'HDD', org_dn: 'org-root/org-PROD/org-VMW', access_policy: 'platform-default'
        }

  - name: Configure Disk Group Policy Use JBOD Disk
    ucs_managed_objects:
      hostname: "{{ ucs_hostname }}"
      username: "{{ ucs_username }}"
      password: "{{ ucs_password }}"
      objects:
      - module: ucsmsdk.mometa.lstorage.LstorageDiskGroupConfigPolicy
        class: LstorageDiskGroupConfigPolicy
        properties:
          parent_mo_or_dn: "{{ item.parent_mo_or_dn }}"
          name: "{{ item.name }}"
        children:
          - module: ucsmsdk.mometa.lstorage.LstorageDiskGroupQualifier
            class: LstorageDiskGroupQualifier
            properties:
              use_jbod_disks: "{{ item.use_jbod_disks }}"
    loop:
      - { parent_mo_or_dn: '{{ ORG }}', name: 'ESX-HOST-2DSK-HD', use_jbod_disks: 'yes' }
      - { parent_mo_or_dn: '{{ ORG }}', name: 'ESX-MGMT-D01-R1', use_jbod_disks: 'yes' }
      - { parent_mo_or_dn: '{{ ORG }}', name: 'ESX-MGMT-D01-R2', use_jbod_disks: 'yes' }